# ProCrop ðŸš€
 
Code and dataset for the AAAI 2026 paper: **ProCrop: Learning Aesthetic Image Cropping from Professional Compositions**  

---
## Create Environment
conda create -n procrop python=3.11 -y

pip install -r requirements.txt

pip install git+https://github.com/openai/CLIP.git

## ðŸ“¦ Repository Contents

Dataset and precomputed retrieval relationship: https://huggingface.co/datasets/BWGZK/procrop_dataset/tree/main
````

---

## ðŸš€ Quick Start
## Step 1: Preprocess the Query and Retrieval Datasets

We adapt code from **RALF** (https://github.com/CyberAgentAILab/RALF) for this step.  
You may skip this step if you are using the **pre-generated queryâ€“retrieval relationship file**.

### 1.1 Extract Query Embeddings
- Extract **SAM embeddings** for the **query dataset**.
- Store the embeddings in an **HDFS file**.

### 1.2 Extract Retrieval Embeddings
- Extract **SAM embeddings** for the **retrieval dataset**.
- Store the embeddings in an **HDFS file**.

### 1.3 Compute Queryâ€“Retrieval Relationships
- For each query image, compute the **top-k most similar images** from the retrieval dataset.
- Save the **queryâ€“retrieval correspondences** to an **HDFS file**.

Step 2: Retrieval-based auto Cropping


## ðŸ“ Dataset

ProCrop includes:

* **Weakly annotated images** generated by out-painting professional images.
* **Diverse crop proposals** obtained through iterative refinement.
* Designed to capture *composition-aware aesthetics* and improve generalization.

> Dataset download and preparation instructions can be found in `datasets/README.md`.

---

## ðŸ“„ Citation

If you use this code or dataset in your research, please cite:

```bibtex
@article{ProCrop2025,
  title={ProCrop: Learning Aesthetic Image Cropping from Professional Compositions},
  author={Zhang, Ke and Ding, Tianyu and Jiang, Jiachen and Chen, Tianyi and Zharkov, Ilya and Patel, Vishal M. and Liang, Luming},
  journal={arXiv preprint arXiv:2505.22490},
  year={2025}
}
```

---

Happy cropping! ðŸŽ¯

[1]: https://arxiv.org/abs/2505.22490 "[2505.22490] ProCrop: Learning Aesthetic Image Cropping from Professional Compositions"

