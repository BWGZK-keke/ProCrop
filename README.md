# ProCrop ğŸš€

**ProCrop** â€” *Learning Aesthetic Image Cropping from Professional Compositions*  
Code and dataset for the paper: **ProCrop: Learning Aesthetic Image Cropping from Professional Compositions**  
ğŸ“„ *arXiv:2505.22490* â€” Ke Zhang, Tianyu Ding, Jiachen Jiang, Tianyi Chen, Ilya Zharkov, Vishal M. Patel, Luming Liang :contentReference[oaicite:1]{index=1}

---

## ğŸ“˜ Overview

Image cropping is a fundamental step in visual content creation and enhancement. Traditional rule-based heuristics and existing learning-based methods often struggle to match the aesthetics of professional photographers. **ProCrop** addresses this gap by learning aesthetic cropping styles directly from professional compositions.

ProCrop introduces:
- A **retrieval-based aesthetic cropping model** that leverages professional images to guide crop selection.
- A **large-scale composition-aware dataset** with 242K weakly annotated images generated through an iterative out-painting and crop proposal refinement pipeline.
- State-of-the-art performance in both **supervised** and **weakly supervised** settings â€” surpassing previous methods and matching fully supervised baselines. :contentReference[oaicite:2]{index=2}

---

## ğŸ“¦ Repository Contents

```

ğŸ“ ProCrop/
â”œâ”€â”€ datasets/               # Dataset scripts & download links
â”œâ”€â”€ models/                 # Model architectures and utilities
â”œâ”€â”€ training/               # Training pipelines and configs
â”œâ”€â”€ evaluation/             # Evaluation scripts and metrics
â”œâ”€â”€ inference/              # Inference pipeline & demo examples
â”œâ”€â”€ logs/                   # Training logs and checkpoints
â”œâ”€â”€ docs/                   # Supplementary documentation
â”œâ”€â”€ LICENSE
â””â”€â”€ README.md

````

---

## ğŸ§  Features

âœ”ï¸ **Professional composition guidance**  
Leverages features from professional photography to drive cropping decisions.

âœ”ï¸ **Large weakly annotated dataset**  
Contains ~242K images and diverse crop proposals generated via out-painting and iterative refinement.

âœ”ï¸ **Flexible training modes**  
Supports both fully supervised and weakly supervised learning.

âœ”ï¸ **State-of-the-art performance**  
Outperforms prior methods and rivals supervised baselines when trained on the ProCrop dataset.

---

## ğŸš€ Quick Start

### 1. Clone the repo
```bash
git clone https://github.com/<your_org>/ProCrop.git
cd ProCrop
````

### 2. Install dependencies

```bash
pip install -r requirements.txt
```

### 3. Download the dataset

```bash
bash scripts/download_dataset.sh
```

### 4. Train the model

```bash
python training/train.py --config configs/procrop_train.yaml
```

### 5. Evaluate

```bash
python evaluation/evaluate.py --model checkpoints/latest.pth
```

### 6. Run inference

```bash
python inference/run_inference.py --input examples/image.jpg
```

---

## ğŸ“ Dataset

ProCrop includes:

* **Weakly annotated images** generated by out-painting professional images.
* **Diverse crop proposals** obtained through iterative refinement.
* Designed to capture *composition-aware aesthetics* and improve generalization.

> Dataset download and preparation instructions can be found in `datasets/README.md`.

---

## ğŸ“„ Citation

If you use this code or dataset in your research, please cite:

```bibtex
@article{ProCrop2025,
  title={ProCrop: Learning Aesthetic Image Cropping from Professional Compositions},
  author={Zhang, Ke and Ding, Tianyu and Jiang, Jiachen and Chen, Tianyi and Zharkov, Ilya and Patel, Vishal M. and Liang, Luming},
  journal={arXiv preprint arXiv:2505.22490},
  year={2025}
}
```

---

## ğŸ§ª Benchmarks

| Method                 | Supervised | Weakly Supervised | Notes                        |
| ---------------------- | ---------- | ----------------- | ---------------------------- |
| ProCrop (Ours)         | âœ“          | âœ“                 | Matches supervised baselines |
| Prior Weak Methods     | âœ—          | âœ“                 | Lower performance            |
| Traditional Heuristics | âœ—          | âœ—                 | Limited aesthetic quality    |

Detailed results and plots are available in `evaluation/results/`.

---

## ğŸ‘¥ Contributors

* **Ke Zhang**
* **Tianyu Ding**
* **Jiachen Jiang**
* **Tianyi Chen**
* **Ilya Zharkov**
* **Vishal M. Patel**
* **Luming Liang**

---

## ğŸ“œ License

This project is released under the **MIT License**.

---

## ğŸ“Œ Contact

For questions or collaborations:

* Open an issue
* Reach out to the authors via email (see paper)

---

Happy cropping! ğŸ¯

[1]: https://arxiv.org/abs/2505.22490 "[2505.22490] ProCrop: Learning Aesthetic Image Cropping from Professional Compositions"

